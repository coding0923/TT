<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.tt.mapper.AttendeeMapper">
<sql id="classColumns">
       user_id
      ,class_id
      ,academy_id
      ,status_yn
      </sql> 
     <insert id="Attendeeput" parameterType="AttendeeDTO">
        INSERT INTO ATTENDEE_TABLE VALUES(#{studentId},#{classId},#{academyId},#{participateStatus},#{attendeeMemo},#{studentId},'',sysdate,'')
     </insert>
    
     <select id="AttendeeList" parameterType="Map" resultType="Map">
         SELECT a.student_id 
           ,b.student_name
           ,b.student_gender
           ,b.student_birthdate
           ,a.participate_status
	     FROM ATTENDEE_TABLE a LEFT OUTER JOIN STUDENT_TABLE b
	     ON(a.student_id = b.student_id )
	     WHERE a.CLASS_ID = #{classId} AND  a.ACADEMY_ID =#{academyId}
	     ORDER BY a.participate_status
    </select>
    
    <update id="AttendeeCall" parameterType="AttendeeDTO">
        UPDATE ATTENDEE_TABLE SET participate_status = #{participateStatus}, update_user =#{updateUser},update_date =sysdate
        WHERE STUDENT_ID = #{studentId} AND CLASS_ID =#{classId} AND ACADEMY_ID = #{academyId}
    </update>
    <update id="AttendeeGiveup" parameterType="AttendeeDTO">
        UPDATE ATTENDEE_TABLE SET participate_status = #{participateStatus}, update_user =#{updateUser}, update_date =sysdate
        WHERE STUDENT_ID = #{studentId} AND CLASS_ID =#{classId} AND ACADEMY_ID = #{academyId}
    </update>
    <delete id="AttendeeDelete" parameterType="AttendeeDTO">
    DELETE FROM ATTENDEE_TABLE WHERE STUDENT_ID = #{studentId} AND CLASS_ID =#{classId} AND ACADEMY_ID = #{academyId}
    </delete>
</mapper> 